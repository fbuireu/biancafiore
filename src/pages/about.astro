---
import { getCollection } from "astro:content";
import BaseLayout from "@components/templates/baseLayout/BaseLayout.astro";
import AboutIntro from "@components/molecules/aboutIntro/AboutIntro.astro";
import LittleMoreOfMe from "@components/organisms/littleMoreOfMe/LittleMoreOfMe.astro";
import AboutLatestArticles from "@components/organisms/aboutLatestArticles/AboutLatestArticles.astro";
import Breadcrumbs from "@components/molecules/breadcrumbs/Breadcrumbs.astro";
import { CONTACT_DETAILS } from "@const/index";
import { authorDTO } from "@application/dto/author";

const authors = await Promise.all((await getCollection("authors")).map(authorDTO.render));
const bianca = authors.find((author) => author.data.name === CONTACT_DETAILS.NAME);
---

<BaseLayout title="" description="">
    <Breadcrumbs classNames="about-page" />
    <AboutIntro />
    <LittleMoreOfMe />
    <AboutLatestArticles />
    <script type="application/ld+json" set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@type': 'ProfilePage',
      'mainEntity': {
        '@id': '#bianca',
        '@type': 'Person',
        'name': bianca.data.name,
        'url': new URL(Astro.url).href,
        'image': new URL(bianca.data.profileImage, Astro.url).href,
        'jobTitle': bianca.data.jobTitle,
        'worksFor': {
          '@type': 'Organization',
          'name': bianca.data.currentCompany,
        },
      },
      'hasPart': [
        {
          '@type': 'Article',
          'headline': bianca.data.latestArticle.title,
          'url': new URL(`articles/${bianca.data.latestArticle.slug}`, Astro.url).href,
          'datePublished': bianca.data.latestArticle.publishDate,
          'author': { '@id': '#bianca' },
        }],
      'sameAs': [...bianca.data.socialNetworks],
    })} />
</BaseLayout>
